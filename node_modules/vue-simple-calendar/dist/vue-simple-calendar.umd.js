(function(m,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(m=typeof globalThis<"u"?globalThis:m||self,e(m.CalendarView={},m.Vue))})(this,function(m,e){"use strict";var et=Object.defineProperty;var tt=(m,e,y)=>e in m?et(m,e,{enumerable:!0,configurable:!0,writable:!0,value:y}):m[e]=y;var L=(m,e,y)=>(tt(m,typeof e!="symbol"?e+"":e,y),y);const y=()=>F(new Date),ee=(t,r,a)=>{switch(r){case"year":return new Date(t.getFullYear(),0);case"month":return new Date(t.getFullYear(),t.getMonth());case"week":return T(t,a);default:return t}},te=t=>[...Array(7)].map((r,a)=>P(t,a)),P=(t,r)=>new Date(t.getFullYear(),t.getMonth(),t.getDate()+r,t.getHours(),t.getMinutes(),t.getSeconds()),T=(t,r)=>P(t,(r-t.getDay()-7)%-7),ae=(t,r)=>P(T(t,r),7),S=t=>new Date(t.getFullYear(),t.getMonth()),ne=t=>Math.ceil(t.getDate()/7),re=(t,r,a)=>new Date(t.getFullYear()+(r=="year"?a:0),t.getMonth()+(r=="month"?a:0),t.getDate()+(r=="week"?a*7:0)),E=t=>("0"+String(t.getMonth()+1)).slice(-2),Y=t=>("0"+String(t.getDate())).slice(-2),U=t=>t.getFullYear()+"-"+E(t),oe=t=>U(t)+"-"+Y(t),se=t=>E(t)+"-"+Y(t),ie=(t,r,a)=>{if(t.getHours()===0&&t.getMinutes()===0&&t.getSeconds()===0)return"";if(!w()){var l=new Date().getTimezoneOffset()*6e4;return new Date(t.getTime()-l).toISOString().slice(11,16)}return t.toLocaleTimeString(r,a)},le=(t,r,a,l)=>{const u=t.getFullYear()===r.getFullYear(),h=R(t,r),b=!(a==="year")&&!(a==="month");let g=[];return g.push(l[t.getMonth()]),b&&(g.push(" "),g.push(t.getDate())),u||(g.push(b?", ":" "),g.push(t.getFullYear())),!h||!u?(g.push(" – "),h||g.push(l[r.getMonth()]),b&&g.push(" ")):b&&g.push(" – "),b?(g.push(r.getDate()),g.push(", ")):g.push(" "),g.push(r.getFullYear()),g.join("")},z=(t,r)=>{const a=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate()),l=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return(a-l)/864e5},de=(t,r)=>!!t&&!!r&&z(t,r)===0,ce=(t,r)=>!!t&&!!r&&t.getTime()===r.getTime(),R=(t,r)=>!!t&&!!r&&t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth(),ue=t=>S(t)<S(y()),ge=t=>S(t)>S(y()),fe=t=>F(t)>y(),me=t=>F(t)<y(),pe=t=>t.getMonth()!==P(t,7).getMonth(),De=t=>t.getMonth()!==P(t,1).getMonth(),j=t=>{let r=[...Array(7)].map(a=>0);return t.split(/\D/,7).forEach((a,l)=>r[l]=Number(a)),r[1]--,new Date(r[0],r[1],r[2],r[3],r[4],r[5],r[6])},A=t=>typeof t=="string"?j(t):new Date(t),F=t=>{const r=new Date(t);return r.setHours(0,0,0,0),r},he=t=>t.substring(0,2),w=()=>typeof Intl<"u",o={addDays:P,beginningOfMonth:S,beginningOfPeriod:ee,beginningOfWeek:T,dateOnly:F,dayDiff:z,daysOfWeek:te,endOfWeek:ae,formattedPeriod:le,formattedTime:ie,fromIsoStringToLocalDate:j,getDefaultBrowserLocale:()=>typeof navigator>"u"?"unk":(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language).toLowerCase(),getFormattedMonthNames:(t,r)=>{if(!w())return[...Array(12)].map(l=>"");const a=new Intl.DateTimeFormat(t,{month:r});return[...Array(12)].map((l,u)=>a.format(new Date(2017,u,1)))},getFormattedWeekdayNames:(t,r,a)=>{if(!w())return[...Array(7)].map(u=>"");const l=new Intl.DateTimeFormat(t,{weekday:r});return[...Array(7)].map((u,h)=>l.format(new Date(2017,0,(h+1+a)%7)))},incrementPeriod:re,instanceOfMonth:ne,isFutureMonth:ge,isInFuture:fe,isInPast:me,isLastDayOfMonth:De,isLastInstanceOfMonth:pe,isoMonthDay:se,isoYearMonth:U,isoYearMonthDay:oe,isPastMonth:ue,isSameDate:de,isSameDateTime:ce,isSameMonth:R,languageCode:he,normalizeItem:(t,r)=>{const a=t.classes?[...t.classes]:[];return r&&a.push("isHovered"),{originalItem:t,startDate:A(t.startDate),endDate:A(t.endDate||t.startDate),classes:a,title:t.title||"Untitled",id:t.id,url:t.url,tooltip:t.tooltip??t.title}},paddedDay:Y,paddedMonth:E,supportsIntl:w,today:y,toLocalDate:A};class ye{constructor(){L(this,"currentDragItem");L(this,"dateSelectionOrigin");L(this,"currentHoveredItemId","");L(this,"CalendarMath",o)}}const be={class:"cv-header-days"},ke={key:0,class:"cv-weeknumber"},Pe=["aria-multiselectable"],Me={key:0,class:"cv-weeknumber"},Se={class:"cv-weekdays"},Ce=["draggable","aria-grabbed","aria-label","aria-selected","aria-dropeffect","onClick","onDragstart","onDrop","onDragover","onDragenter","onDragleave"],Ie={class:"cv-day-number"},Oe=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick","innerHTML"],Le=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick"],Fe=e.defineComponent({__name:"CalendarView",props:{showDate:{default:void 0},displayPeriodUom:{default:"month"},displayPeriodCount:{default:1},displayWeekNumbers:{type:Boolean,default:!1},locale:{default:void 0},monthNameFormat:{default:"long"},weekdayNameFormat:{default:"short"},showTimes:{type:Boolean,default:!1},timeFormatOptions:{default:()=>({})},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},enableDateSelection:{type:Boolean,default:!1},selectionStart:{default:void 0},selectionEnd:{default:void 0},enableDragDrop:{type:Boolean,default:!1},startingDayOfWeek:{default:0},items:{default:()=>[]},dateClasses:{default:()=>({})},itemTop:{default:"1.4em"},itemContentHeight:{default:"1.4em"},itemBorderHeight:{default:"2px"},periodChangedCallback:{type:Function,default:void 0},currentPeriodLabel:{default:""},currentPeriodLabelIcons:{default:"⇤-⇥"},doEmitItemMouseEvents:{type:Boolean,default:!1},enableHtmlTitles:{type:Boolean,default:!0}},emits:["period-changed","click-date","click-item","item-mouseenter","item-mouseleave","drag-start","drag-over-date","drag-enter-date","drag-leave-date","drop-on-date","date-selection","date-selection-start","date-selection-finish"],setup(t,{emit:r}){const a=t,l=e.reactive(new ye),u=e.computed(()=>a.locale||o.getDefaultBrowserLocale()),h=e.computed(()=>a.showDate?o.dateOnly(a.showDate):o.today()),p=e.computed(()=>o.beginningOfPeriod(h.value,a.displayPeriodUom,a.startingDayOfWeek)),C=e.computed(()=>o.addDays(o.incrementPeriod(p.value,a.displayPeriodUom,a.displayPeriodCount),-1)),b=e.computed(()=>{const n=o.beginningOfWeek(o.beginningOfPeriod(p.value,"year",0),a.startingDayOfWeek),i=o.beginningOfWeek(p.value,a.startingDayOfWeek);return 1+Math.floor(o.dayDiff(n,i)/7)}),g=e.computed(()=>o.beginningOfWeek(p.value,a.startingDayOfWeek)),N=e.computed(()=>o.endOfWeek(C.value,a.startingDayOfWeek)),We=e.computed(()=>{const n=Math.floor((o.dayDiff(g.value,N.value)+1)/7);return[...Array(n)].map((i,d)=>o.addDays(g.value,d*7))}),W=e.computed(()=>o.getFormattedMonthNames(u.value,a.monthNameFormat)),Ve=e.computed(()=>o.getFormattedWeekdayNames(u.value,a.weekdayNameFormat,a.startingDayOfWeek)),V=e.computed(()=>a.items?a.items.map(n=>o.normalizeItem(n,n.id===l.currentHoveredItemId)):[]),H=e.computed(()=>o.beginningOfPeriod(o.today(),a.displayPeriodUom,a.startingDayOfWeek)),He=e.computed(()=>o.addDays(o.incrementPeriod(H.value,a.displayPeriodUom,a.displayPeriodCount),-1)),xe=e.computed(()=>o.formattedPeriod(p.value,C.value,a.displayPeriodUom,W.value)),Ue=e.computed(()=>{const n=H.value,i=p.value;return a.currentPeriodLabel?a.currentPeriodLabel==="icons"?a.currentPeriodLabelIcons[Math.sign(n.getTime()-i.getTime())+1]:a.currentPeriodLabel:o.formattedPeriod(n,He.value,a.displayPeriodUom,W.value)}),ze=e.computed(()=>({previousYear:M(-12),previousPeriod:M(-1),nextPeriod:M(1),previousFullPeriod:M(-a.displayPeriodCount),nextFullPeriod:M(a.displayPeriodCount),nextYear:M(12),currentPeriod:H.value,currentPeriodLabel:Ue.value,periodStart:p.value,periodEnd:C.value,displayLocale:u.value,displayFirstDate:g.value,displayLastDate:N.value,monthNames:W.value,fixedItems:V.value,periodLabel:xe.value})),Re=e.computed(()=>({periodStart:p,periodEnd:C,displayFirstDate:g,displayLastDate:N}));e.watch(()=>Re,n=>{a.periodChangedCallback&&(r("period-changed"),a.periodChangedCallback(n,"watch"))},{immediate:!0,deep:!0});const je=(n,i)=>{a.disablePast&&o.isInPast(n)||a.disableFuture&&o.isInFuture(n)||r("click-date",n,J(n,n),i)},q=(n,i)=>r("click-item",n,i),I=n=>"dow"+(n+a.startingDayOfWeek)%7,M=n=>{const i=o.incrementPeriod(p.value,a.displayPeriodUom,n),d=o.incrementPeriod(i,a.displayPeriodUom,a.displayPeriodCount);return a.disablePast&&d<=o.today()||a.disableFuture&&i>o.today()?null:i},v=(n,i)=>{l.currentHoveredItemId=n.id,a.doEmitItemMouseEvents&&r("item-mouseenter",n,i)},G=(n,i)=>{l.currentHoveredItemId="",a.doEmitItemMouseEvents&&r("item-mouseleave",n,i)},qe=(n,i)=>{var f,s;if(!a.enableDateSelection)return!1;(f=i.dataTransfer)==null||f.setData("text",n.toString());let d=new Image;return d.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",(s=i.dataTransfer)==null||s.setDragImage(d,10,10),l.dateSelectionOrigin=n,r("date-selection-start",x(n),i),!0},Q=(n,i)=>{var d;return a.enableDragDrop?((d=i.dataTransfer)==null||d.setData("text",n.id),l.currentDragItem=n,l.dateSelectionOrigin=void 0,r("drag-start",n,i),!0):!1},x=n=>n<=l.dateSelectionOrigin?[n,l.dateSelectionOrigin]:[l.dateSelectionOrigin,n],ve=(n,i)=>{a.enableDragDrop&&r("drag-over-date",l.currentDragItem,n,i)},Ge=(n,i)=>{if(a.enableDateSelection&&l.dateSelectionOrigin&&r("date-selection",x(n),i),!a.enableDragDrop)return;r("drag-enter-date",l.currentDragItem,n,i),i.target.classList.add("draghover")},Qe=(n,i)=>{if(a.enableDateSelection&&a.selectionStart||!a.enableDragDrop)return;r("drag-leave-date",l.currentDragItem,n,i),i.target.classList.remove("draghover")},Je=(n,i)=>{if(a.enableDateSelection&&l.dateSelectionOrigin){r("date-selection-finish",x(n),i);return}if(!a.enableDragDrop)return;r("drop-on-date",l.currentDragItem,n,i),i.target.classList.remove("draghover")},Ke=(n,i)=>n.startDate<i.startDate?-1:i.startDate<n.startDate?1:n.endDate>i.endDate?-1:i.endDate>n.endDate?1:n.id<i.id?-1:1,Xe=n=>J(n,o.addDays(n,6)),J=(n,i)=>V.value.filter(d=>d.endDate>=n&&o.dateOnly(d.startDate)<=i,this).sort(Ke),Ze=n=>!!V.value.find(i=>i.endDate>=n&&o.dateOnly(i.startDate)<=n),K=n=>!(!a.selectionStart||!a.selectionEnd||n<o.dateOnly(a.selectionStart)||n>o.dateOnly(a.selectionEnd)),X=n=>{const i=Xe(n),d=[],f=[[],[],[],[],[],[],[]];if(!i)return d;for(let s=0;s<i.length;s++){const c=Object.assign({},i[s],{classes:[...i[s].classes],itemRow:0}),D=c.startDate<n,O=D?0:o.dayDiff(n,c.startDate),_=Math.min(7-O,o.dayDiff(o.addDays(n,O),c.endDate)+1);D&&c.classes.push("continued"),o.dayDiff(n,c.endDate)>6&&c.classes.push("toBeContinued"),o.isInPast(c.endDate)&&c.classes.push("past"),c.originalItem.url&&c.classes.push("hasUrl");for(let k=0;k<7;k++)if(k===O){let $=0;for(;f[k][$];)$++;c.itemRow=$,f[k][$]=!0}else k<O+_&&(f[k][c.itemRow]=!0);c.classes.push(`offset${O}`),c.classes.push(`span${_}`),d.push(c)}return d},_e=n=>{const i='<span class="startTime">'+o.formattedTime(n.startDate,u.value,a.timeFormatOptions)+"</span>";let d="";return o.isSameDateTime(n.startDate,n.endDate)||(d='<span class="endTime">'+o.formattedTime(n.endDate,u.value,a.timeFormatOptions)+"</span>"),i+d},Z=n=>a.showTimes?_e(n)+" "+n.title:n.title,B=n=>{const i=n.itemRow,d=a.itemContentHeight,f=a.itemBorderHeight;return`calc(${a.itemTop} + ${i}*${d} + ${i}*${f})`};return(n,i)=>(e.openBlock(),e.createElementBlock("div",{"aria-label":"Calendar",class:e.normalizeClass(["cv-wrapper",`locale-${e.unref(o).languageCode(e.unref(u))}`,`locale-${e.unref(u)}`,`y${e.unref(p).getFullYear()}`,`m${e.unref(o).paddedMonth(e.unref(p))}`,`period-${t.displayPeriodUom}`,`periodCount-${t.displayPeriodCount}`,{past:e.unref(o).isPastMonth(e.unref(p)),future:e.unref(o).isFutureMonth(e.unref(p)),noIntl:!e.unref(o).supportsIntl}])},[e.renderSlot(n.$slots,"header",{headerProps:e.unref(ze)}),e.createElementVNode("div",be,[t.displayWeekNumbers?(e.openBlock(),e.createElementBlock("div",ke)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(Ve),(d,f)=>e.renderSlot(n.$slots,"dayHeader",{index:I(f),label:d},()=>[(e.openBlock(),e.createElementBlock("div",{key:I(f),class:e.normalizeClass([I(f),"cv-header-day"])},e.toDisplayString(d),3))])),256))]),e.createElementVNode("div",{"aria-multiselectable":t.enableDateSelection,class:"cv-weeks"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(We),(d,f)=>(e.openBlock(),e.createElementBlock("div",{key:`${f}-week`,class:e.normalizeClass(["cv-week",`week${f+1}`,`ws${e.unref(o).isoYearMonthDay(d)}`])},[t.displayWeekNumbers?(e.openBlock(),e.createElementBlock("div",Me,[e.renderSlot(n.$slots,"weekNumber",{date:d,numberInYear:e.unref(b)+f,numberInPeriod:f+1},()=>[e.createElementVNode("span",null,e.toDisplayString(e.unref(b)+f),1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Se,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o).daysOfWeek(d),(s,c)=>(e.openBlock(),e.createElementBlock("div",{key:I(c),draggable:t.enableDateSelection,class:e.normalizeClass(["cv-day",I(c),`d${e.unref(o).isoYearMonthDay(s)}`,`d${e.unref(o).isoMonthDay(s)}`,`d${e.unref(o).paddedDay(s)}`,`instance${e.unref(o).instanceOfMonth(s)}`,{today:e.unref(o).isSameDate(s,e.unref(o).today()),outsideOfMonth:!e.unref(o).isSameMonth(s,e.unref(h)),past:e.unref(o).isInPast(s),future:e.unref(o).isInFuture(s),last:e.unref(o).isLastDayOfMonth(s),lastInstance:e.unref(o).isLastInstanceOfMonth(s),hasItems:Ze(s),selectionStart:e.unref(o).isSameDate(s,t.selectionStart),selectionEnd:e.unref(o).isSameDate(s,t.selectionEnd)},...t.dateClasses&&t.dateClasses[e.unref(o).isoYearMonthDay(s)]||[]]),"aria-grabbed":t.enableDateSelection?K(s):void 0,"aria-label":s.getDate().toString(),"aria-selected":K(s),"aria-dropeffect":t.enableDragDrop&&l.currentDragItem?"move":t.enableDateSelection&&l.dateSelectionOrigin?"execute":"none",onClick:D=>je(s,D),onDragstart:D=>qe(s,D),onDrop:e.withModifiers(D=>Je(s,D),["prevent"]),onDragover:e.withModifiers(D=>ve(s,D),["prevent"]),onDragenter:e.withModifiers(D=>Ge(s,D),["prevent"]),onDragleave:e.withModifiers(D=>Qe(s,D),["prevent"])},[e.createElementVNode("div",Ie,e.toDisplayString(s.getDate()),1),e.renderSlot(n.$slots,"dayContent",{day:s})],42,Ce))),128)),a.enableHtmlTitles?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(X(d),s=>e.renderSlot(n.$slots,"item",{value:s,weekStartDate:d,top:B(s)},()=>[(e.openBlock(),e.createElementBlock("div",{key:s.id,draggable:t.enableDragDrop,"aria-grabbed":t.enableDragDrop?s==l.currentDragItem:void 0,class:e.normalizeClass([s.classes,"cv-item"]),title:s.tooltip||s.title,style:e.normalizeStyle(`top:${B(s)};${s.originalItem.style}`),onDragstart:c=>Q(s,c),onMouseenter:c=>v(s,c),onMouseleave:c=>G(s,c),onClick:e.withModifiers(c=>q(s,c),["stop"]),innerHTML:Z(s)},null,46,Oe))])),256)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(X(d),s=>e.renderSlot(n.$slots,"item",{value:s,weekStartDate:d,top:B(s)},()=>[(e.openBlock(),e.createElementBlock("div",{key:s.id,draggable:t.enableDragDrop,"aria-grabbed":t.enableDragDrop?s==l.currentDragItem:void 0,class:e.normalizeClass([s.classes,"cv-item"]),title:s.tooltip||s.title,style:e.normalizeStyle(`top:${B(s)};${s.originalItem.style}`),onDragstart:c=>Q(s,c),onMouseenter:c=>v(s,c),onMouseleave:c=>G(s,c),onClick:e.withModifiers(c=>q(s,c),["stop"])},e.toDisplayString(Z(s)),47,Le)),e.createTextVNode(" div> ")])),256))])],2))),128))],8,Pe)],2))}}),st="",we={class:"cv-header"},Be={class:"cv-header-nav"},$e=["disabled"],Te=["disabled","innerHTML"],Ee=["disabled"],Ye=["disabled"],Ae={class:"periodLabel"},Ne=e.defineComponent({__name:"CalendarViewHeader",props:{headerProps:{type:Object,required:!0},previousYearLabel:{type:String,default:"<<"},previousPeriodLabel:{type:String,default:"<"},nextPeriodLabel:{type:String,default:">"},nextYearLabel:{type:String,default:">>"}},emits:["input"],setup(t,{emit:r}){const a=l=>r("input",l);return(l,u)=>(e.openBlock(),e.createElementBlock("div",we,[e.createElementVNode("div",Be,[e.createElementVNode("button",{disabled:!t.headerProps.previousYear,class:"previousYear","aria-label":"Previous Year",onClick:u[0]||(u[0]=e.withModifiers(h=>a(t.headerProps.previousYear),["prevent"]))},e.toDisplayString(t.previousYearLabel),9,$e),e.createElementVNode("button",{disabled:!t.headerProps.previousPeriod,class:"previousPeriod","aria-label":"Previous Period",onClick:u[1]||(u[1]=e.withModifiers(h=>a(t.headerProps.previousPeriod),["prevent"])),innerHTML:t.previousPeriodLabel},null,8,Te),e.createElementVNode("button",{class:"currentPeriod","aria-label":"Current Period",onClick:u[2]||(u[2]=e.withModifiers(h=>a(t.headerProps.currentPeriod),["prevent"]))},e.toDisplayString(t.headerProps.currentPeriodLabel),1),e.createElementVNode("button",{disabled:!t.headerProps.nextPeriod,class:"nextPeriod","aria-label":"Next Period",onClick:u[3]||(u[3]=e.withModifiers(h=>a(t.headerProps.nextPeriod),["prevent"]))},e.toDisplayString(t.nextPeriodLabel),9,Ee),e.createElementVNode("button",{disabled:!t.headerProps.nextYear,class:"nextYear","aria-label":"Next Year",onClick:u[4]||(u[4]=e.withModifiers(h=>a(t.headerProps.nextYear),["prevent"]))},e.toDisplayString(t.nextYearLabel),9,Ye)]),e.createElementVNode("div",Ae,[e.renderSlot(l.$slots,"label",{},()=>[e.createTextVNode(e.toDisplayString(t.headerProps.periodLabel),1)])])]))}}),it="";m.CalendarMath=o,m.CalendarView=Fe,m.CalendarViewHeader=Ne,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
